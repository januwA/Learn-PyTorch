# CNN 手写数字识别 (MNIST Hello World)

本项目是 PyTorch 学习的入门实验，通过构建一个简单的卷积神经网络 (CNN) 来识别 MNIST 手写数字数据集。不仅支持单数字识别，还通过 OpenCV 实现了多数字图象分割与推理。

## 📁 目录结构

- `main.py`: 核心训练脚本。负责定义 CNN 模型、加载 MNIST 数据集、执行训练并保存模型权重 (`mnist_cnn.pt`)。
- `predict.py`: 推理脚本。使用 OpenCV 对输入图片进行预处理（彩色转灰度、高斯模糊、二值化、轮廓分割），然后利用训练好的模型进行预测。
- `test.jpg`: 用于测试的本地图片（建议白底黑字，书写清晰）。

## 🚀 快速开始

### 1. 安装依赖

本项目使用 `uv` 进行包管理。请确保已安装 `uv`，然后运行：

```powershell
uv add torch torchvision torchaudio opencv-python Pillow
```

### 2. 训练模型

运行以下命令开始训练。模型会自动下载 MNIST 数据集（约 60MB），训练 1 轮（Epoch）后准确率通常可达 96%+。

```powershell
uv run CNN_01/main.py
```

训练完成后，会在当前目录下生成 `mnist_cnn.pt` 文件。

### 3. 图片推理

准备一张包含手写数字的图片（如 `test.jpg`），然后运行：

```powershell
uv run CNN_01/predict.py
```

程序会弹出窗口显示中间处理过程（模糊、二值化），按任意键继续，最后在控制台输出识别结果。

## 🧠 模型架构 (SimpleCNN)

- **卷积层 1**: 1 -> 32 通道, 3x3 卷积核
- **池化层 1**: 2x2 最大池化
- **卷积层 2**: 32 -> 64 通道, 3x3 卷积核
- **池化层 2**: 2x2 最大池化
- **全连接层 1**: 展平后连接至 128 个神经元
- **输出层**: 10 个神经元（对应数字 0-9）

## 💡 实验心得

1. **预处理的重要性**: MNIST 原始数据是黑底白字的 $28 \times 28$ 灰度图。我们在推理本地图片时，必须通过 OpenCV 进行“反色”和“填充”，使图片风格贴近训练集，才能获得高准确率。
2. **端到端 vs 分割**: 本项目采用了“先分割、后识别”的流水线方案。若要实现更高级的“一键识别”，可以研究 CRNN + CTC Loss 方案。
